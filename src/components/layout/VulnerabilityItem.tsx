import JaggedBox from "./JaggedBox";

interface VulnerabilityItemProps {
  scanType: "quick" | "deep";
  resource?: string;
  rule?: string;
  severity?: string | null;
  description?: string;
  line?: string;
  recommendation?: string;
}

function VulnerabilityItem({
  scanType,
  resource,
  rule,
  severity,
  description,
  line,
  recommendation,
}: VulnerabilityItemProps) {
  const severityColor =
    severity === "High"
      ? "text-red-500"
      : severity === "Medium"
      ? "text-yellow-500"
      : severity === "Low"
      ? "text-green-500"
      : "text-quaternary-red";

  return (
    <div className="flex gap-1 -mx-12 mb-6">
      <div
        id="multi-jagged"
        className="w-50 border-2 border-tertiary-red"
      ></div>
      <JaggedBox className="text-quaternary-red w-full">
        <div className="flex p-4 gap-4 font-orbitron text-sm font-bold text-justify items-center">
          {scanType === "quick" && (
            <>
              <div className="w-[30%] border-2 border-tertiary-red py-4 px-2 flex items-center justify-center">
                {rule}
              </div>
              <div className="w-[40%] border-2 border-tertiary-red py-4 px-2 flex items-center">
                {resource}
              </div>
              <div
                className={`w-[30%] border-2 border-tertiary-red py-4 px-2 flex items-center justify-center ${severityColor}`}
              >
                {severity}
              </div>
            </>
          )}
          {scanType === "deep" && (
            <>
              <div className="w-[20%] border-2 border-tertiary-red py-4 px-2 flex items-center justify-center">
                {rule}
              </div>
              <div className="w-[25%] border-2 border-tertiary-red py-4 px-2 flex items-center">
                {description}
              </div>
              <div className="w-[15%] border-2 border-tertiary-red py-4 px-2 flex items-center justify-center">
                {line}
              </div>
              <div
                className={`w-[15%] border-2 border-tertiary-red py-4 px-2 flex items-center justify-center ${severityColor}`}
              >
                {severity || "N/A"}
              </div>
              <div className="w-[25%] border-2 border-tertiary-red py-4 px-2 flex items-center">
                {recommendation}
              </div>
            </>
          )}
        </div>
      </JaggedBox>
    </div>
  );
}

export default VulnerabilityItem;
